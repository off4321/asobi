---
doc-id: "security-oauth2-flow-018"
title: "OAuth 2.0 認証フロー (Authorization Code Grant)"
tags: ["認証", "セキュリティ", "OAuth", "OIDC", "API"]
versions: "1.0"
---
# OAuth 2.0 認証フロー (Authorization Code Grant)
このドキュメントは、サードパーティアプリケーションがユーザーの代わりにリソースにアクセスするための標準的なフレームワークであるOAuth 2.0の「Authorization Code Grant」フローを解説します。

---
## 1. 概要
- **目的**: ユーザー名とパスワードを**サードパーティ（クライアント）に渡すことなく**、リソースサーバーへのアクセス権（アクセストークン）を付与する。
- **安全性**: 最も一般的に使用され、セキュリティが高いフロー。

---
## 2. フローの主要ステップ
| ステップ | 動作 | 主な役割 |
|---|---|---|
| **1. 認可リクエスト** | クライアントがユーザーを認可サーバーへリダイレクトする。 | クライアント、ユーザー |
| **2. 認可コード取得** | ユーザーが認証・認可した後、認可サーバーがクライアントへ**認可コード**を発行する。 | 認可サーバー |
| **3. トークン交換** | クライアントが**認可コード**と**クライアントシークレット**を認可サーバーに送信する。 | クライアント |
| **4. トークン発行** | 認可サーバーが**アクセストークン**（とリフレッシュトークン）を発行する。 | 認可サーバー |
| **5. リソースアクセス** | クライアントが**アクセストークン**を使ってリソースサーバーにアクセスする。 | クライアント、リソースサーバー |

---
## 3. Authorization Code Grant シーケンス図
クライアント、認可サーバー、リソースサーバー間の連携を図示します。

```mermaid
sequenceDiagram
    participant C as クライアント
    participant U as ユーザーブラウザ
    participant AS as 認可サーバー
    participant RS as リソースサーバー

    U->>C: リソースへのアクセス要求
    C->>U: ASへリダイレクト(Scope, ClientID)
    U->>AS: 認証・認可の実行
    AS->>U: 認可コードを付与してCへリダイレクト
    U->>C: 認可コードを受領
    C->>AS: 認可コード & Client Secret
    AS-->>C: アクセストークン
    C->>RS: アクセストークンを使用してリソース取得
    RS-->>C: リソースデータ
```