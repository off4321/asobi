---
doc-id: "db-nosql-modeling-016"
title: "NoSQLデータモデリングの基本"
tags: ["データベース", "NoSQL", "データモデリング", "性能最適化"]
versions: "1.0"
---
# NoSQLデータモデリングの基本
このドキュメントは、MongoDBやDynamoDBなどのNoSQLデータベースにおけるデータモデリングの基本原則、特に**非正規化**（Denormalization）とアクセスパターンに焦点を当てて説明します。

---
## 1. 概要
- **目的**: NoSQLの特性（柔軟性、スケーラビリティ、高速なクエリ）を最大限に活用するためのデータ構造を設計する。
- **原則**: **アクセスパターン（利用方法）**を事前に把握し、それに合わせてデータを物理的に配置する。

---
## 2. 正規化と非正規化
リレーショナルデータベース (RDB) の**正規化**（冗長性を排除し整合性を高める）とは対照的に、NoSQLでは**非正規化**（意図的に冗長性を持たせる）が頻繁に行われます。

| 特性 | RDB (正規化) | NoSQL (非正規化) |
|---|---|---|
| **目的** | 整合性の維持、冗長性の排除 | クエリの高速化、I/O回数の最小化 |
| **データ取得** | 複雑なJOINが必要 | 単一リクエスト（One-to-One）で取得可能 |
| **データ構造** | 分割（複数のテーブル） | 埋め込み（単一のドキュメント） |

---
## 3. 非正規化のテクニック
### ✅ 埋め込み (Embedding)
- 一対一（1:1）や一対多（1:N）の関係を持つデータを、単一のドキュメント内にネストして保存する。
- **例**: 注文情報の中に顧客の配送先住所を埋め込む。

### ✅ 参照 (Referencing)
- 伝統的なRDBの外部キーのように、別のドキュメントのIDをフィールドとして持つ。
- データの冗長性がなくなり、更新の整合性が保たれやすい。

---
## 4. 埋め込みの概念図
顧客と注文のデータを埋め込みで表現する概念図です。

```mermaid
graph TD
    A[顧客ドキュメント (Customer)] -- 埋め込み --> B[注文リスト (Orders Array)];
    B -- 埋め込み --> C[製品情報 (Product Details)];
    subgraph ドキュメント全体
        A
    end
```