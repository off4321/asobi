---
doc-id: "cloud-lb-strategies-012"
title: "マイクロサービスにおけるロードバランシング戦略"
tags: ["クラウド", "インフラ", "ロードバランシング", "マイクロサービス"]
versions: "1.0"
---
# マイクロサービスにおけるロードバランシング戦略
このドキュメントは、分散システムおよびマイクロサービスアーキテクチャで採用される主要なロードバランシングアルゴリズムとその特性を説明します。

---
## 1. 概要
- **目的**: 複数のサーバーインスタンスにトラフィックを効率的に分散し、**可用性の向上**と**応答時間の短縮**を実現する。
- **場所**: L4 (ネットワーク層)、L7 (アプリケーション層)、サイドカープロキシなど。

---
## 2. ロードバランシングアルゴリズム
### ✅ 静的アルゴリズム (Static Algorithms)
- サーバーの現在の負荷状態を考慮せず、事前に決められたルールに従って分配します。

| アルゴリズム | 説明 | 特性 |
|---|---|---|
| **ラウンドロビン** (Round Robin) | サーバーを順番に循環してリクエストを割り当てる。 | シンプルで実装が容易。サーバー性能に差がある場合に偏りが生じる。 |
| **重み付きラウンドロビン** (Weighted RR) | サーバーの性能（重み）に基づいて、より多くのリクエストを性能の高いサーバーに割り当てる。 | サーバー性能の差を吸収できる。 |

### ✅ 動的アルゴリズム (Dynamic Algorithms)
- サーバーのリアルタイムな負荷状態（CPU使用率、応答時間など）を考慮して分配します。

| アルゴリズム | 説明 | 特性 |
|---|---|---|
| **最小コネクション** (Least Connection) | 現在アクティブなコネクション数が**最も少ない**サーバーにリクエストを割り当てる。 | セッション維持時間が長い場合に有効。 |
| **最小応答時間** (Least Response Time) | 応答時間が**最も短い**サーバーにリクエストを割り当てる。 | パフォーマンスが最適化される傾向がある。 |

---
## 3. ロードバランサーの配置
クラウド環境では、外部トラフィックとサービス間通信の両方にロードバランサーが使用されます。

```mermaid
graph LR
    A[外部クライアント] --> B{L7 ロードバランサー};
    B --> C1[マイクロサービス A];
    B --> C2[マイクロサービス B];
    C1 --> D{サイドカープロキシ / L4};
    C2 --> D;
    D --> E1[DBサービス インスタンス 1];
    D --> E2[DBサービス インスタンス 2];
    D --> E3[DBサービス インスタンス 3];